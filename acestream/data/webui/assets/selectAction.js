import{d as ve,u as Z,c as m,a as fe,b as _e,o as H,n as he,g as me,e as ye,f as C,h as Q,r as y,w as L,_ as we,i as ge,E as be,j as ke,k as N,l as k,m as S,p as b,q as x,t as E,s as R,F as Ce,v as Se,x as P,y as Ee,z as Ae,A as Pe,B as Ie,C as Me,D as Ne,G as xe,H as $,R as Oe,I as Re,J as $e,K as Ue,L as Te}from"./_plugin-vue_export-helper.js";function ht(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const ee=ve("main",()=>{const o=Z(),n=m(()=>{var c,l;return(l=(c=window.AceStreamConfig)==null?void 0:c.host)!=null?l:window.location.hostname}),s=m(()=>{var c,l,u;return(u=(l=(c=window.AceStreamConfig)==null?void 0:c.httpPort)!=null?l:o.query.engineHttpPort)!=null?u:6878}),i=m(()=>{var c,l;return(l=(c=window.AceStreamConfig)==null?void 0:c.apiAccessToken)!=null?l:""});return{...fe(),..._e(),engineHost:n,enginePort:s,engineApiAccessToken:i}});function We(o){return me()?(ye(o),!0):!1}function De(o){return typeof o=="function"?o():C(o)}const He=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function Le(o){return o||Q()}function ze(o,n=!0,s){Le()?H(o,s):n?o():he(o)}function I(o){var n;const s=De(o);return(n=s==null?void 0:s.$el)!=null?n:s}const te=He?window:void 0;function Ve(){const o=y(!1),n=Q();return n&&H(()=>{o.value=!0},n),o}function Be(o){const n=Ve();return m(()=>(n.value,!!o()))}function Ye(o,n,s={}){const{window:i=te,...c}=s;let l;const u=Be(()=>i&&"ResizeObserver"in i),d=()=>{l&&(l.disconnect(),l=void 0)},_=m(()=>Array.isArray(o)?o.map(a=>I(a)):[I(o)]),r=L(_,a=>{if(d(),u.value&&i){l=new ResizeObserver(n);for(const h of a)h&&l.observe(h,c)}},{immediate:!0,flush:"post"}),v=()=>{d(),r()};return We(v),{isSupported:u,stop:v}}function Fe(o,n={width:0,height:0},s={}){const{window:i=te,box:c="content-box"}=s,l=m(()=>{var a,h;return(h=(a=I(o))==null?void 0:a.namespaceURI)==null?void 0:h.includes("svg")}),u=y(n.width),d=y(n.height),{stop:_}=Ye(o,([a])=>{const h=c==="border-box"?a.borderBoxSize:c==="content-box"?a.contentBoxSize:a.devicePixelContentBoxSize;if(i&&l.value){const w=I(o);if(w){const g=i.getComputedStyle(w);u.value=Number.parseFloat(g.width),d.value=Number.parseFloat(g.height)}}else if(h){const w=Array.isArray(h)?h:[h];u.value=w.reduce((g,{inlineSize:A})=>g+A,0),d.value=w.reduce((g,{blockSize:A})=>g+A,0)}else u.value=a.contentRect.width,d.value=a.contentRect.height},s);ze(()=>{const a=I(o);a&&(u.value="offsetWidth"in a?a.offsetWidth:n.width,d.value="offsetHeight"in a?a.offsetHeight:n.height)});const r=L(()=>I(o),a=>{u.value=a?n.width:0,d.value=a?n.height:0});function v(){_(),r()}return{width:u,height:d,stop:v}}const Ge="3.2.3.0",qe=o=>(Ae("data-v-103f81e3"),o=o(),Pe(),o),Xe={class:"page-container"},Je={key:0,class:"fill-height d-flex align-center justify-center w-100 flex-column"},Ke={key:1},je=qe(()=>b("div",{style:{"text-align":"start","font-size":"18px","padding-bottom":"8px"}}," Ace Stream ",-1)),Ze={style:{"text-align":"start","padding-bottom":"32px"}},Qe={style:{"text-align":"center"}},et={key:2},tt={class:"menu-container"},ot={class:"menu-title"},nt=["onClick"],st={key:0,class:"icon"},at={class:"material-symbols-outlined"},lt={class:"title"},it={class:"menu-actions"},ct=328,rt=128,ut=128,X="open-our-player",J="open-local-player",K="open-remote-player",U="show-other-players",T="show-remote-devices",W="share",pt="download",D="open-link",j="copy-link",dt={__name:"ContentStart",setup(o){const n=Z(),s=ge(),i=ee();let c=null;const l=new be(i.engineHost,i.enginePort,i.engineApiAccessToken),u=y(!1),d=y(null),_=y([]),r=y(null),v=y([]),a=y(null),h=Fe(a),w=y(null),g=y(null);L([h.width,h.height],e=>{console.log("page size changed: ".concat(JSON.stringify(e)));const t=e[0],f=e[1];if(t>0&&f>0){const p=Math.max(ct,t+rt),M=f+ut;Ie(p,M)}});const A=m(()=>n.query.uri),O=m(()=>{var t;const e=(t=w.value)==null?void 0:t.infohash;return e?"acestream:?infohash=".concat(e):null}),V=m(()=>{var e;return(e=w.value)==null?void 0:e.title}),oe=m(()=>["acestreamcast"]),B=m(()=>{const e=_.value.filter(t=>t.type==="engine_api");return e.length>0?e[0]:null}),Y=m(()=>_.value.filter(e=>e.type==="proxy")),F=m(()=>_.value.filter(e=>oe.value.indexOf(e.protocol)!==-1)),ne=m(()=>{const e=[];if(!r.value)B.value&&e.push({id:X,title:"Ace Player",icon:"play_arrow",player:B.value}),Y.value.length>0&&e.push({id:U,title:s.t("other_players"),icon:"desktop_windows"}),F.value.length>0&&e.push({id:T,title:s.t("play_on_remote_device"),icon:"cast"}),O.value&&e.push({id:W,title:s.t("share"),icon:"share"});else if(r.value==U)for(const t of Y.value)e.push({id:J,title:t.name,icon:null,player:t});else if(r.value==T)for(const t of F.value)e.push({id:K,title:t.name,icon:null,player:t});else if(r.value==W){const t=O.value,f=V.value;e.push({id:j,title:s.t("copy_link"),icon:null,url:t}),e.push({id:D,title:"WhatsApp",icon:null,url:"https://wa.me/?text=".concat(f,"%0D%0A").concat(t)}),e.push({id:D,title:"Twitter (X)",icon:null,url:"https://twitter.com/intent/tweet?url=".concat(t)}),e.push({id:D,title:"Pinterest",icon:null,url:"https://pinterest.com/pin/create/button/?url=".concat(t)})}return e}),se=m(()=>{let e;switch(r.value){case U:e=s.t("choose_player");break;case T:e=s.t("choose_device");break;case W:e=s.t("share");break;default:e=s.t("choose_action")}return e});H(async()=>{try{u.value=!0,await le(),await G(),c=setInterval(G,5e3)}catch(e){console.error("Error: ".concat(e)),d.value=ae(e)}finally{u.value=!1}}),ke(()=>{c&&clearInterval(c)});function ae(e){return e==="empty query"?"empty_query":e&&e.startsWith("analyze failed")?"analyze_failed":e}async function le(){const e=await l.analyzeContent(A.value);console.log("analyzeContent",e),w.value=e}async function G(){try{const e=await l.getAvailablePlayers();_.value=e.players}catch(e){console.error("Failed to get players: ".concat(e))}}function ie(e,t,f,p){const M=i.isDev?"/ui/src/apps/remote-control/#/play":"/ui/acecast/remote-control/#/play",q=i.enginePort;return"".concat(M,"?engineHttpPort=").concat(encodeURIComponent(q),"&host=").concat(encodeURIComponent(e),"&websocketPort=").concat(encodeURIComponent(t),"&uri=").concat(encodeURIComponent(f),"&title=").concat(encodeURIComponent(p))}function ce(e){v.value.push(e),r.value=e}function re(){v.value.pop(),r.value=v.value.length>0?v.value[v.value.length-1]:null}function ue(e){switch(e.id){case X:case J:case K:de(e.player);break;case U:case T:case W:ce(e.id);break;case D:window.open(e.url),P();break;case j:console.log("set_clipboard: text=".concat(JSON.stringify(O.value))),pe(O.value),i.showToast(s.t("link_copied"));break;case pt:console.log("download");break}}function pe(e){const t=g.value;t.style.display="block",t.value=e,t.select(),document.execCommand("copy"),t.style.display="none"}async function de(e){var t;try{if(console.log("openInPlayer",e),e.protocol=="acestreamcast"){const f=e.device_info.host,p=e.device_info.websocket_port;p?window.location.href=ie(f,p,A.value,V.value):i.showToast(s.t("update_acecast_receiver",{version:Ge}),0)}else{let f;((t=w.value)==null?void 0:t.content_type)==="direct_content"?f={transportType:"direct",directUrl:w.value.item_url}:f={uri:A.value};const p=await l.openInPlayer(e.id,f);console.log("openInPlayer",p),P()}}catch(f){console.error("Failed to open in player: ".concat(f))}}return(e,t)=>{const f=N("v-progress-circular");return k(),S("div",Xe,[b("div",{class:"page",ref_key:"pageElement",ref:a},[u.value?(k(),S("div",Je,[x(f,{indeterminate:"",size:"64",width:"2"})])):d.value?(k(),S("div",Ke,[je,b("div",Ze,E(e.$t("errors.".concat(d.value))),1),b("div",Qe,[b("div",{class:"my-button",onClick:t[0]||(t[0]=(...p)=>C(P)&&C(P)(...p)),onMousedown:t[1]||(t[1]=R(()=>{},["stop"]))},E(e.$t("close")),33)])])):(k(),S("div",et,[b("div",tt,[b("div",ot,E(se.value),1),b("div",{class:"menu-items",onMousedown:t[2]||(t[2]=R(()=>{},["stop"]))},[(k(!0),S(Ce,null,Se(ne.value,(p,M)=>(k(),S("div",{class:"menu-item",key:M,onClick:q=>ue(p)},[p.icon?(k(),S("div",st,[b("span",at,E(p.icon),1)])):Ee("",!0),b("div",lt,E(p.title),1)],8,nt))),128))],32),b("div",it,[v.value.length>0?(k(),S("div",{key:0,class:"my-button",onClick:re,onMousedown:t[3]||(t[3]=R(()=>{},["stop"]))},E(e.$t("back")),33)):(k(),S("div",{key:1,class:"my-button",onClick:t[4]||(t[4]=(...p)=>C(P)&&C(P)(...p)),onMousedown:t[5]||(t[5]=R(()=>{},["stop"]))},E(e.$t("cancel")),33))]),b("input",{ref_key:"inputShareUrl",ref:g,type:"text",style:{display:"none"}},null,512)])]))],512)])}}},vt=we(dt,[["__scopeId","data-v-103f81e3"]]),ft=Me({history:Ne(),routes:[{path:"/",name:"home",component:vt}]}),_t={__name:"App",setup(o){const n=ee(),s=y(!1),i=y(0),c=y(0);function l(_){s.value=!0,i.value=_.screenX,c.value=_.screenY}function u(_){if(s.value){const r=i.value-_.screenX,v=c.value-_.screenY;i.value-=r,c.value-=v,$e(-r,-v)}}function d(){s.value=!1}return(_,r)=>{const v=N("v-btn"),a=N("v-snackbar"),h=N("v-main"),w=N("v-app");return k(),xe(w,null,{default:$(()=>[x(h,{onMousedown:l,onMousemove:u,onMouseup:d,onMouseleave:d},{default:$(()=>[x(C(Oe)),x(a,{"multi-line":!0,"min-width":"100%",timeout:"-1",modelValue:C(n).toast.visible,"onUpdate:modelValue":r[1]||(r[1]=g=>C(n).toast.visible=g)},{actions:$(()=>[x(v,{icon:"mdi-close",onClick:r[0]||(r[0]=g=>C(n).toast.visible=!1)})]),default:$(()=>[Re(E(C(n).toast.text)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})}}},z=Ue(_t);z.use(ft);Te(z);z.mount("#app");export{ht as __vite_legacy_guard};
