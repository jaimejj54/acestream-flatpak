on:
  push:
    branches: [master]
  pull_request:
name: CI
jobs:
  flatpak:
    name: "Flatpak"
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with: 
        submodules: recursive
    - name: "Install flatpak-builder"
      run: |
        sudo apt install flatpak-builder -y
        flatpak remote-add --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo
    - name: "Build flatpak"
      run: |
        flatpak-builder --force-clean --install-deps-from=flathub --repo=repo builddir org.Acestream.engine.yml
        flatpak build-bundle repo acestream-engine.flatpak org.Acestream.engine
    - name: Use the Upload Artifact GitHub Action
      uses: actions/upload-artifact@v4
      with: 
        name: org.Acestream.engine.flatpak
        path: org.Acestream.engine.flatpak
      
